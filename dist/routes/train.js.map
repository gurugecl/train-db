{"version":3,"sources":["../../routes/train.js"],"names":["require","Router","pool","router","get","request","response","next","query","err","res","json","rows","id","params","post","body","name","personality","redirect","put","keys","fields","forEach","key","push","field","index","length","delete","module","exports"],"mappings":";;eAAmBA,QAAQ,SAAR,C;IAAXC,M,YAAAA,M;;AACR,IAAMC,OAAOF,QAAQ,OAAR,CAAb;;AAEA,IAAMG,SAASF,QAAf;;AAEAE,OAAOC,GAAP,CAAW,GAAX,EAAgB,UAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AACzCL,SAAKM,KAAL,CAAW,wCAAX,EAAqD,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC/D,YAAID,GAAJ,EAAS,OAAOF,KAAKE,GAAL,CAAP;;AAETH,iBAASK,IAAT,CAAcD,IAAIE,IAAlB;AACH,KAJD;AAKH,CAND;;AAQAT,OAAOC,GAAP,CAAW,MAAX,EAAmB,UAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAAA,QACpCM,EADoC,GAC7BR,QAAQS,MADqB,CACpCD,EADoC;;;AAG5CX,SAAKM,KAAL,CAAW,sCAAX,EAAmD,CAACK,EAAD,CAAnD,EAAyD,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACnE,YAAID,GAAJ,EAAS,OAAOF,KAAKE,GAAL,CAAP;;AAETH,iBAASK,IAAT,CAAcD,IAAIE,IAAlB;AACH,KAJD;AAKH,CARD;;AAUAT,OAAOY,IAAP,CAAY,GAAZ,EAAiB,UAACV,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAAA,wBACZF,QAAQW,IADI;AAAA,QAClCC,IADkC,iBAClCA,IADkC;AAAA,QAC5BC,WAD4B,iBAC5BA,WAD4B;;;AAG1ChB,SAAKM,KAAL,CACI,wDADJ,EAEI,CAACS,IAAD,EAAOC,WAAP,CAFJ,EAGI,UAACT,GAAD,EAAMC,GAAN,EAAc;AACV,YAAID,GAAJ,EAAS,OAAOF,KAAKE,GAAL,CAAP;;AAETH,iBAASa,QAAT,CAAkB,WAAlB;AACH,KAPL;AASH,CAZD;;AAcAhB,OAAOiB,GAAP,CAAW,MAAX,EAAmB,UAACf,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAAA,QACpCM,EADoC,GAC7BR,QAAQS,MADqB,CACpCD,EADoC;;AAE5C,QAAMQ,OAAO,CAAC,MAAD,EAAS,aAAT,CAAb;AACA,QAAMC,SAAS,EAAf;;AAEAD,SAAKE,OAAL,CAAa,eAAO;AAChB,YAAIlB,QAAQW,IAAR,CAAaQ,GAAb,CAAJ,EAAuBF,OAAOG,IAAP,CAAYD,GAAZ;AAC1B,KAFD;;AAIAF,WAAOC,OAAP,CAAe,UAACG,KAAD,EAAQC,KAAR,EAAkB;AAC7BzB,aAAKM,KAAL,0BAC2BkB,KAD3B,0BAEI,CAACrB,QAAQW,IAAR,CAAaU,KAAb,CAAD,EAAsBb,EAAtB,CAFJ,EAGI,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACV,gBAAID,GAAJ,EAAS,OAAOF,KAAKE,GAAL,CAAP;;AAET,gBAAIkB,UAAUL,OAAOM,MAAP,GAAgB,CAA9B,EAAiCtB,SAASa,QAAT,CAAkB,WAAlB;AACpC,SAPL;AASH,KAVD;AAWH,CApBD;;AAsBAhB,OAAO0B,MAAP,CAAc,MAAd,EAAsB,UAACxB,OAAD,EAAUC,QAAV,EAAoBC,IAApB,EAA6B;AAAA,QACvCM,EADuC,GAChCR,QAAQS,MADwB,CACvCD,EADuC;;;AAG/CX,SAAKM,KAAL,CAAW,oCAAX,EAAiD,CAACK,EAAD,CAAjD,EAAuD,UAACJ,GAAD,EAAMC,GAAN,EAAc;AACjE,YAAID,GAAJ,EAAS,OAAOF,KAAKE,GAAL,CAAP;;AAETH,iBAASa,QAAT,CAAkB,WAAlB;AACH,KAJD;AAKH,CARD;;AAUAW,OAAOC,OAAP,GAAiB5B,MAAjB","file":"train.js","sourcesContent":["const { Router } = require('express');\r\nconst pool = require('../db');\r\n\r\nconst router = Router();\r\n\r\nrouter.get('/', (request, response, next) => {\r\n    pool.query('SELECT * FROM profiles ORDER BY id ASC', (err, res) => {\r\n        if (err) return next(err);\r\n\r\n        response.json(res.rows);\r\n    });\r\n});\r\n\r\nrouter.get('/:id', (request, response, next) => {\r\n    const { id } = request.params;\r\n\r\n    pool.query('SELECT * FROM profiles WHERE id = $1', [id], (err, res) => {\r\n        if (err) return next(err);\r\n\r\n        response.json(res.rows);\r\n    });\r\n});\r\n\r\nrouter.post('/', (request, response, next) => {\r\n    const { name, personality } = request.body;\r\n\r\n    pool.query(\r\n        'INSERT INTO profiles(name, permissions) VALUES($1, $2)',\r\n        [name, personality],\r\n        (err, res) => {\r\n            if (err) return next(err);\r\n\r\n            response.redirect('/profiles');\r\n        }\r\n    );\r\n});\r\n\r\nrouter.put('/:id', (request, response, next) => {\r\n    const { id } = request.params;\r\n    const keys = ['name', 'permissions'];\r\n    const fields = [];\r\n\r\n    keys.forEach(key => {\r\n        if (request.body[key]) fields.push(key);\r\n    });\r\n\r\n    fields.forEach((field, index) => {\r\n        pool.query(\r\n            `UPDATE profiles SET ${field}=($1) WHERE id=($2)`,\r\n            [request.body[field], id],\r\n            (err, res) => {\r\n                if (err) return next(err);\r\n\r\n                if (index === fields.length - 1) response.redirect('/profiles');\r\n            }\r\n        )\r\n    });\r\n});\r\n\r\nrouter.delete('/:id', (request, response, next) => {\r\n    const { id } = request.params;\r\n\r\n    pool.query('DELETE FROM profiles WHERE id=($1)', [id], (err, res) => {\r\n        if (err) return next(err);\r\n\r\n        response.redirect('/profiles');\r\n    });\r\n});\r\n\r\nmodule.exports = router;"]}